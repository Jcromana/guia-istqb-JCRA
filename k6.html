<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guía de Instalación y Uso de k6 en macOS</title>
    <style>
        /* Estilos generales y tipografía */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        /* Contenedor principal */
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 25px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        /* Títulos */
        h1, h2, h3 {
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        h1 { font-size: 2.2em; }
        h2 { font-size: 1.8em; margin-top: 40px; }
        h3 { font-size: 1.4em; border-bottom: none; }

        /* Párrafos y listas */
        p, li {
            font-size: 1.1em;
        }
        ul {
            padding-left: 20px;
        }

        /* Bloques de código */
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            position: relative; /* Necesario para el botón de copiar */
        }
        code {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            font-size: 0.95em;
        }
        
        /* Código en línea */
        p > code, li > code {
            background-color: #e0e0e0;
            color: #d63384;
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* Botón de copiar */
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        pre:hover .copy-btn {
            opacity: 1;
        }
        .copy-btn:active {
            background-color: #5a6268;
        }

        /* Links */
        a {
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
            color: #777;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Guía Completa para k6 en macOS</h1>
        <p>Una guía paso a paso para instalar, configurar y ejecutar tus primeras pruebas de rendimiento con k6 en un entorno macOS.</p>

        <section id="instalacion">
            <h2>Paso 1: Instalación de k6</h2>
            <p>La forma más sencilla y recomendada de instalar k6 en macOS es a través de <strong>Homebrew</strong>, un popular gestor de paquetes.</p>

            <h3>1.1 - Instalar Homebrew (si no lo tienes)</h3>
            <p>Abre la aplicación <strong>Terminal</strong> y pega el siguiente comando:</p>
            <pre><button class="copy-btn">Copiar</button><code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></pre>

            <h3>1.2 - Instalar k6 con Homebrew</h3>
            <p>Una vez que Homebrew esté listo, instala k6 con este simple comando:</p>
            <pre><button class="copy-btn">Copiar</button><code>brew install k6</code></pre>

            <h3>1.3 - Verificar la Instalación</h3>
            <p>Para confirmar que k6 se ha instalado correctamente, ejecuta el siguiente comando. Deberías ver la versión de k6 instalada.</p>
            <pre><button class="copy-btn">Copiar</button><code>k6 version</code></pre>
        </section>

        <section id="uso-basico">
            <h2>Paso 2: Cómo Usar k6 (Tu Primera Prueba)</h2>
            <p>El uso de k6 se basa en escribir scripts de prueba en JavaScript y ejecutarlos desde la terminal.</p>

            <h3>2.1 - Crear el Script de Prueba</h3>
            <p>Crea un archivo llamado <code>mi-prueba.js</code> y pega el siguiente código. Este script simula un usuario que visita una página de prueba.</p>
            <pre><button class="copy-btn">Copiar</button><code>import http from 'k6/http';
import { check, sleep } from 'k6';

// 1. Opciones de la prueba (Configuración)
export const options = {
  // Simula 1 usuario virtual (VU)
  vus: 1,
  // Durante 30 segundos
  duration: '30s',
};

// 2. Código del usuario virtual (Lo que hará cada usuario)
export default function () {
  // Realiza una petición GET a la URL de prueba de k6
  const res = http.get('https://test.k6.io');

  // 3. Verificaciones (Checks) para validar la respuesta
  check(res, {
    'El estado es 200': (r) => r.status === 200,
  });

  // Espera 1 segundo antes de la siguiente iteración
  sleep(1);
}</code></pre>

            <h3>2.2 - Ejecutar la Prueba</h3>
            <p>En tu terminal, navega a la carpeta donde guardaste el archivo <code>mi-prueba.js</code> y ejecuta el comando:</p>
            <pre><button class="copy-btn">Copiar</button><code>k6 run mi-prueba.js</code></pre>
        </section>

        <section id="analisis-resultados">
    <h2>Paso 3: Entendiendo los Resultados</h2>
    <p>Al finalizar la prueba, k6 te mostrará un resumen con métricas clave. Aquí están las más importantes para empezar, con ejemplos para entender qué significan:</p>
    <ul>
        <li>
            <strong><code>checks</code></strong>: El porcentaje de tus verificaciones que pasaron.
            <br>
            <em>Ejemplo:</em> Si tu script tiene <code>check(res, {'El estado es 200': (r) => r.status === 200})</code> y esta métrica es del 90%, significa que el 10% de las respuestas del servidor no tuvieron el código de estado 200. ¡Busca siempre el 100%!
        </li>
        <br>
        <li>
            <strong><code>http_reqs</code></strong>: El número total de peticiones HTTP que se realizaron durante la prueba.
            <br>
            <em>Ejemplo:</em> Si tu prueba duró 30 segundos y ves <code>http_reqs: 150</code>, significa que tu sistema manejó un promedio de 5 peticiones por segundo (RPS).
        </li>
        <br>
        <li>
            <strong><code>http_req_failed</code></strong>: El porcentaje de peticiones que fallaron. Un fallo puede ser un error de conexión, un timeout o una respuesta inválida del servidor (como un error 500).
            <br>
            <em>Ejemplo:</em> Un valor de <code>5%</code> indica que 5 de cada 100 peticiones no se completaron correctamente. Un sistema saludable debería tener este valor en <strong>0%</strong>.
        </li>
        <br>
        <li>
            <strong><code>http_req_duration</code></strong>: Mide cuánto tiempo tardó el servidor en procesar y responder a una petición, sin contar el tiempo de espera de la red. Es la métrica más importante para medir la velocidad de tu backend.
            <ul>
                <br>
                <li><strong><code>avg</code> (Promedio):</strong> El tiempo medio de respuesta. Es útil, pero puede ser engañoso si hay valores extremos.</li>
                <li><strong><code>min</code> y <code>max</code> (Mínimo y Máximo):</strong> Te muestran el mejor y el peor tiempo de respuesta. Un <code>max</code> muy alto puede indicar un problema puntual en tu servidor.</li>
                <li><strong><code>p(90)</code>, <code>p(95)</code> (Percentiles):</strong> Son las métricas más valiosas. <code>p(95)=130.6ms</code> significa que el 95% de tus usuarios experimentaron un tiempo de respuesta inferior a 130.6ms, mientras que el 5% más lento tuvo una respuesta peor. Es un indicador mucho más realista de la experiencia del usuario que el promedio.</li>
            </ul>
        </li>
        <br>
        <li>
            <strong><code>vus</code></strong>: El número de usuarios virtuales activos durante la prueba. Te ayuda a confirmar que la carga se aplicó como esperabas.
        </li>
        <br>
        <li>
            <strong><code>iterations</code></strong>: El número total de veces que se ejecutó la función principal de tu script. Te da una idea del volumen total de ciclos de usuario completados.
        </li>
    </ul>
</section>
        
        <section id="proximos-pasos">
            <h2>Próximos Pasos</h2>
            <p>¡Felicidades! Has completado tu primera prueba de carga. Ahora puedes:</p>
            <ul>
                <li><strong>Aumentar la carga:</strong> Modifica las <code>options</code> en tu script para simular más usuarios (<code>vus</code>) o una mayor duración (<code>duration</code>).</li>
                <li><strong>Probar tu propia API:</strong> Cambia la URL en <code>http.get()</code> por un endpoint de tu aplicación.</li>
                <li><strong>Explorar la documentación:</strong> Para aprender sobre escenarios avanzados, umbrales y más, visita la <a href="https://k6.io/docs/" target="_blank">documentación oficial de k6</a>.</li>
            </ul>
        </section>

        <footer>
            <p>Página generada como guía rápida para usar k6 en macOS.</p>
        </footer>
    </div>

    <script>
        // Funcionalidad para los botones de "Copiar"
        document.addEventListener('DOMContentLoaded', () => {
            const copyButtons = document.querySelectorAll('.copy-btn');
            copyButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const pre = button.parentElement;
                    const code = pre.querySelector('code');
                    const textToCopy = code.innerText;

                    navigator.clipboard.writeText(textToCopy).then(() => {
                        button.innerText = '¡Copiado!';
                        setTimeout(() => {
                            button.innerText = 'Copiar';
                        }, 2000);
                    }).catch(err => {
                        console.error('Error al copiar el texto: ', err);
                    });
                });
            });
        });
    </script>

</body>
</html>
